version: "3.8"

services:
  webhook-app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: webhook-uangkas
    ports:
      - "8081:8080"
    environment:
      # Database Configuration - Using external PostgreSQL (existing data)
      QUARKUS_DATASOURCE_JDBC_URL: jdbc:postgresql://159.65.0.183:5432/webhook_db
      QUARKUS_DATASOURCE_USERNAME: lifestyle
      QUARKUS_DATASOURCE_PASSWORD: ismailganteng

      # Flyway Configuration
      QUARKUS_FLYWAY_MIGRATE_AT_START: "true"

      # Webhook Configuration
      WEBHOOK_SECRET: 7toU/dBMNYpSQpMYMXUTPywrPmrbv6vOkqa7Y8f7tHw=
      WEBHOOK_VALIDATION_ENABLED: "false"

      # Email Configuration (Youtoria SMTP)
      MAILER_USERNAME: ${MAILER_USERNAME:-no-reply@youtoria.live}
      SMTP_PASSWORD: ${SMTP_PASSWORD:-23,eneuRR,:}
      ADMIN_EMAIL: ${ADMIN_EMAIL:-addplay44@gmail.com}
      NOTIFICATION_EMAIL_ENABLED: "true"
    networks:
      - webhook-network
    restart: unless-stopped

  # PostgreSQL container removed - using external database at 159.65.0.183

networks:
  webhook-network:
    driver: bridge
